<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Stampie - 盖章 PDF 工具</title>
    <link rel="stylesheet" href="styles.css" />
    <!-- pdf.js (viewer only) -->
    <script src="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <!-- pdf-lib (for writing flattened PDF) -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  </head>
  <body>
    <header class="toolbar">
      <div class="file-inputs">
        <label class="btn">
          <span data-i18n="choosePdf">选择 PDF</span>
          <input id="pdfFile" type="file" accept="application/pdf" />
        </label>
        <label class="btn">
          <span data-i18n="chooseSealImage">选择印章图片 (PNG/JPG)</span>
          <input id="sealFile" type="file" accept="image/png, image/jpeg" />
        </label>
      </div>
      <div class="controls">
        <button id="prevPage" disabled><span data-i18n="prevPage">上一页</span></button>
        <span id="pageInfo">— / —</span>
        <button id="nextPage" disabled><span data-i18n="nextPage">下一页</span></button>
        <label class="inline">
          <span data-i18n="zoomLabel">视图缩放</span>
          <input id="zoom" type="range" min="50" max="200" value="100" />
        </label>
      </div>
      <div class="actions">
        <button id="exportBtn" disabled><span data-i18n="exportFlattened">导出压平副本</span></button>
        <label class="inline">
          <span data-i18n="langLabel">语言</span>
          <select id="langSwitch">
            <option value="zh">中文</option>
            <option value="en">English</option>
          </select>
        </label>
      </div>
    </header>

    <main class="workspace">
      <aside class="panel">
        <div class="panel-section">
          <h3><span data-i18n="sealSettings">印章设置</span></h3>
          <div class="seal-preview" id="sealPreviewWrap">
            <span class="hint" data-i18n="noSealSelected">未选择印章</span>
          </div>
          <label>
            <span data-i18n="sizePixels">大小（像素）</span>
            <input id="sealSize" type="range" min="32" max="800" value="200" disabled />
          </label>
          <div class="size-presets">
            <span class="hint" data-i18n="sizePresets">大小预设</span>
            <div class="preset-buttons">
              <button id="preset45" disabled>45 mm</button>
              <button id="preset42" disabled>42 mm</button>
              <button id="preset40" disabled>40 mm</button>
            </div>
          </div>
          <label>
            <span data-i18n="opacity">不透明度</span>
            <input id="sealOpacity" type="range" min="10" max="100" value="100" disabled />
          </label>
          <div class="panel-buttons">
            <button id="placeSeal" disabled><span data-i18n="placeOnPage">在页面放置</span></button>
            <button id="confirmSeal" disabled><span data-i18n="confirmAdd">确认添加</span></button>
            <button id="cancelSeal" disabled><span data-i18n="cancel">取消</span></button>
          </div>
        </div>
        <div class="panel-section">
          <h3><span data-i18n="currentPageStamps">当前页印章</span></h3>
          <div id="stampsList" class="stamps-list empty" data-i18n-empty="none">暂无</div>
          <div class="panel-buttons">
            <button id="undoStamp" disabled><span data-i18n="undoLastOnPage">撤销本页最后一个</span></button>
            <button id="clearPage" disabled><span data-i18n="clearPage">清空本页</span></button>
          </div>
        </div>
      </aside>

      <section class="viewer">
        <div id="pageContainer" class="page-container">
          <canvas id="pdfCanvas"></canvas>
          <!-- overlay 用于交互放置与拖动印章 -->
          <div id="overlay" class="overlay hidden">
            <img id="overlayImg" alt="seal" />
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <span data-i18n="footerHint">提示：使用鼠标拖动印章移动位置，滚轮或滑块调整大小。</span>
    </footer>

    <script src="app.js"></script>
  </body>
  </html>
